<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="生物信息学实战转录组入门任务清单  参考流程 计算机资源的准备 系统环境及硬件配置：  macOS High Sierra 10.13.4 MacBool Air (13-inch, Early 2015) 处理器   1.6GHz intel Core i5 内存  4GB 1600MHz DDR3 存储  128G uname -a  x86_64   安装Homebrew包管理，要求预先安装">
<meta property="og:type" content="article">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://yoursite.com/2018/04/03/transcriptome/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="生物信息学实战转录组入门任务清单  参考流程 计算机资源的准备 系统环境及硬件配置：  macOS High Sierra 10.13.4 MacBool Air (13-inch, Early 2015) 处理器   1.6GHz intel Core i5 内存  4GB 1600MHz DDR3 存储  128G uname -a  x86_64   安装Homebrew包管理，要求预先安装">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2018-04-15T07:53:46.324Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hexo">
<meta name="twitter:description" content="生物信息学实战转录组入门任务清单  参考流程 计算机资源的准备 系统环境及硬件配置：  macOS High Sierra 10.13.4 MacBool Air (13-inch, Early 2015) 处理器   1.6GHz intel Core i5 内存  4GB 1600MHz DDR3 存储  128G uname -a  x86_64   安装Homebrew包管理，要求预先安装">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2018/04/03/transcriptome/"/>





  <title> | Hexo</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hexo</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/03/transcriptome/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline"></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-03T21:29:10+08:00">
                2018-04-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="生物信息学实战"><a href="#生物信息学实战" class="headerlink" title="生物信息学实战"></a>生物信息学实战</h1><h2 id="转录组入门"><a href="#转录组入门" class="headerlink" title="转录组入门"></a><a href="https://xiapengfei1996.github.io/bioinfo/transcriptome" target="_blank" rel="noopener">转录组入门</a></h2><p><a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247484843&amp;idx=1&amp;sn=95370393e9d16e09e854adce78c94523&amp;chksm=9b484510ac3fcc064b1bfc19f5cc73a4fbc113a840a40c3a95632127c54f570d9d66550ebc22&amp;scene=21#wechat_redirect" target="_blank" rel="noopener">任务清单</a>  <a href="https://mp.weixin.qq.com/s?__biz=MzAxMDkxODM1Ng==&amp;mid=2247485440&amp;idx=1&amp;sn=392c8649e334af99ac60e903aaec01e9&amp;chksm=9b4848bbac3fc1ad02ac2f11fd9f4440fb13cffc063d19da56fe34317d0621a4972ec26a41d1&amp;mpshare=1&amp;scene=23&amp;srcid=04136Qg8PRlWmG5bwOcYtjwq%23rd" target="_blank" rel="noopener">参考流程</a></p>
<h3 id="计算机资源的准备"><a href="#计算机资源的准备" class="headerlink" title="计算机资源的准备"></a>计算机资源的准备</h3><ul>
<li><p>系统环境及硬件配置：</p>
<ul>
<li>macOS High Sierra 10.13.4</li>
<li>MacBool Air (13-inch, Early 2015)</li>
<li>处理器   1.6GHz intel Core i5</li>
<li>内存  4GB 1600MHz DDR3</li>
<li>存储  128G</li>
<li><code>uname -a</code>  x86_64</li>
</ul>
</li>
<li><p>安装Homebrew包管理，要求预先安装Xcode；<br>（App Store中Xcode要求macOS High Sierra 10.13.2以上）</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"</span><br></pre></td></tr></table></figure>
</li>
<li><p>用homebrew安装wget；（也可在<a href="rudix.org/packages/wget.html">rudix网站</a>上下载wget安装包）</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install wget</span><br></pre></td></tr></table></figure>
</li>
<li><p><a href="https://zhuanlan.zhihu.com/p/25085567" target="_blank" rel="noopener">wget下载miniconda</a>；<br>此处注意网上教程多在Linux或Windows虚拟Ubantu系统下操作，要注意下载MacOSX版文件！</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://repo.continuum.io/miniconda/Miniconda3-latest-MacOSX-x86_64.sh</span><br></pre></td></tr></table></figure>
</li>
<li><p>bash安装miniconda；</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash Miniconda3-latest-MacOSX-x86_64.sh</span><br></pre></td></tr></table></figure>
</li>
<li><p>输入yes接受条款；</p>
</li>
<li><p>回车确认安装位置；</p>
</li>
<li><p>输入yes确定PATH；</p>
</li>
<li><p>source完成最后安装；<br>此处注意MacOSX系统中不是<code>.bashrc</code>，应根据反馈结果修改为<code>.bash_profile</code>！</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source ~/.bash_profile</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看是否安装成功；</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda</span><br></pre></td></tr></table></figure>
</li>
<li><p>更新miniconda；</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda update conda</span><br></pre></td></tr></table></figure>
</li>
<li><p>添加channels,即为conda增加软件源；</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">conda config - add channels r</span><br><span class="line">conda config - add channels bioconda</span><br><span class="line">conda config - add channels defaults</span><br><span class="line">conda config – add channels conda-forge</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看添加的频道；</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda config – get channels</span><br></pre></td></tr></table></figure>
</li>
<li><p>添加清华源镜像；</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">conda config - add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/</span><br><span class="line">conda config - add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge/</span><br><span class="line">conda config - add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/msys2/</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示已添加的源镜像地址；</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda config --set show_channel_urls yes</span><br></pre></td></tr></table></figure>
</li>
<li><p>安装sratoolkit,fastqc,hisats,samtools,htseq-count,R,Rstudio软件；</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">conda install -c bioconda sra-tools</span><br><span class="line">conda install -c bioconda fastqc</span><br><span class="line">conda install -c bioconda hisat2</span><br><span class="line">conda install -c bioconda samtools</span><br><span class="line">conda install -c bioconda htseq</span><br><span class="line"><span class="meta">#</span> 本机已安装过R和RStudio,故未重复下载</span><br><span class="line"><span class="meta">#</span> conda install r</span><br><span class="line"><span class="meta">#</span> conda install rstudio</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="读文章拿到测序数据"><a href="#读文章拿到测序数据" class="headerlink" title="读文章拿到测序数据"></a>读文章拿到测序数据</h3><ul>
<li><p>检索实战学习示例文章；<br><a href="https://www.nature.com/articles/ncomms13347" target="_blank" rel="noopener">AKAP95 regulates splicing through scaffolding RNAs and RNA processing factors. Nat Commun 2016 Nov 8;7:13347. PMID: 27824034</a></p>
</li>
<li><p>阅读文章Methods部分，尤Bioinformatic analyses和Data availability部分；</p>
<blockquote>
<p>Bioinformatic analyses<br>We obtained 35–55 million of paired 51 bp reads for each sample. The investigator was blinded to sample identities when performing bioinformatic analyses. All the reads were mapped to the <strong>human reference genome (GRCh37/hg19)</strong> using <strong>TopHat (v2.0.13)</strong> with a <strong>gene transfer file (GTF version GRCh37.70)</strong>. <strong>Low quality mapped reads (MQ&gt;30)</strong> were removed from the analysis. The <strong>mean insert sizes and the s.d.’s</strong> were calculated using <a href="http://broadinstitute.github.io/picard/" target="_blank" rel="noopener"><strong>Picard-tools (v1.126)</strong></a>.<br>For mRNA-Seq, <strong>read count tables</strong> were generated using <strong>HTSeq (v0.6.0)53</strong> and <strong>deferential expression (DE) analysis of genes</strong> were performed using <strong>DESeq (v3.0)54</strong>. <strong>Deferential exon usage</strong> was performed using <strong>DEXSeq (v3.1)29</strong>. Two independent biological repeats for control and KD were included in both DEseq and DEXseq. <em><strong>For 293 cells, the mRNA-seq results of the control samples include (1) those from the doxycycline-treated parental Flp-In T-REx 293 cells by us and (2) those from the doxycycline-treated control Flp-In T-REx 293 cells performed by another group unrelated to us (sample GSM1095127 in GSE44976)31, and the two AKAP95 KD samples were from the two different clones (miR#8 and miR#12) of Flp-In T-REx 293 cells stably expressing AKAP95 microRNAs after doxycycline treatment.</strong></em> For mouse ES cells, the two biological repeats for both control and shRNA#1-mediated Akap95 KD were independently generated by two different persons in our lab. The <strong>read per million normalized BigWig files</strong> were generated using <strong>BEDTools (v2.17.0)55</strong> and <strong>bedGraphToBigWig tool (v4)</strong>. All the <strong>downstream statistical analyses</strong> and generating <strong>plots</strong> were performed in <a href="http://www.r-project.org/" target="_blank" rel="noopener"><strong>R (v3.1.1)</strong></a>. <strong>Gene ontology analysis</strong> was performed at <a href="http://david.ncifcrf.gov/" target="_blank" rel="noopener"><strong>DAVID</strong></a>.<br>For RIP-Seq, mapped files were passed to Model-based Analysis of ChIP-Seq (MACS) (v1.4.2 20120305)56 for peak calling and <a href="http://homer.salk.edu/homer/" target="_blank" rel="noopener">HOMER (vv3.12, 6-8-2012)</a>57 was used for Motif finding. Bedgraph files generated by MACS were then normalized based on read per million and converted to BigWig files using bedGraphToBigWig. The input RNA-seq files were not subject to MACS. The genomic regions for annotation (intergenic regions, exons, UTRs, distal and proximal introns) were extracted from the GTF file used above. Peak annotations and coverage calculations for these genomic regions were performed using Bedtools and SAMtools (v0.1.18)58, respectively. Profile plots were generated by ngs.plot (v2.47)59.</p>
</blockquote>
</li>
</ul>
<blockquote>
<p>Data availability<br>The RIP-seq an RNA-seq data have been deposited in the Gene Expression Omnibus database, with accession code <strong>GSE81916</strong>. All other data is available from the author upon reasonable request.</p>
</blockquote>
<ul>
<li>在<a href="https://www.ncbi.nlm.nih.gov/geo/" target="_blank" rel="noopener">GEO</a>上查找<a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE81916" target="_blank" rel="noopener"><strong>GSE81916</strong></a>,查找得其对应的SRA号为<strong>SRP075747</strong>（以及BioProject号<strong>PRJNA323422</strong>）；</li>
</ul>
<blockquote>
<p>Overall design<br>Samples 1-8 are RNA-immunoprecipitation (RIP)-seq to determine AKAP95 binding to the transcriptome. <strong>Samples 9-15 are mRNA-seq</strong> to determine effect of AKAP95 knockdown in human 293 cells (9-11) or mouse ES cells (12-15).</p>
</blockquote>
<ul>
<li><p>阅读网页Overall design部分介绍得知，属于RNA-seq数据的是第9-15个样品；</p>
</li>
<li><p>在<a href="https://trace.ncbi.nlm.nih.gov/Traces/sra/sra.cgi?view=search_obj" target="_blank" rel="noopener">SRA</a>上查找<a href="https://trace.ncbi.nlm.nih.gov/Traces/study/?acc=SRP075747&amp;go=go" target="_blank" rel="noopener"><strong>SRP075747</strong></a>（或<a href="https://trace.ncbi.nlm.nih.gov/Traces/study/?acc=PRJNA323422" target="_blank" rel="noopener"><strong>PRJNA323422</strong></a>）,查找得其第9-15个样品，即<strong>GSM2177723</strong>到<strong>GSM2177729</strong>对应的SRA号为<strong>SRR3589956</strong>到<strong>SRR3589962</strong>；<br><em>注意理解GEO/SRA数据库的数据存放形式</em></p>
</li>
<li><p>安装axel来下载数据比wget及prefetch更快；（也可使用<a href="http://www.bio-info-trainee.com/bioconductor_China/software/GEOquery.html" target="_blank" rel="noopener">GEOquery</a>下载）<br>（Aspera只有Windows系统下的client）</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install axel</span><br></pre></td></tr></table></figure>
</li>
<li><p>循环axel语句实现数据下载；<br>（<strong>2200+KB/s，用时约两小时</strong>）</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">for i in &#123;56..62&#125;  # &#123;56..62&#125;与`seq 57 62`等价</span><br><span class="line">do</span><br><span class="line">  axel ftp://ftp-trace.ncbi.nih.gov/sra/sra-instant/reads/ByStudy/sra/SRP/SRP075/SRP075747/SRR35899$i/SRR35899$i.sra</span><br><span class="line">done</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="了解fastq测序数据"><a href="#了解fastq测序数据" class="headerlink" title="了解fastq测序数据"></a>了解fastq测序数据</h3><ul>
<li><p>循环sratoolkit（sra-tools）中fastq-dump语句把sra文件转换为fastq格式；<br>（<strong>用时约三个半小时</strong>）<br>注意这一步不显示百分数进度条！</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">fastq-dump -h # 查看帮助文件</span><br><span class="line">for i in &#123;56..62&#125;</span><br><span class="line">do</span><br><span class="line">  fastq-dump --gzip --split-3 -O /Users/xiapengfei/ -A SRR35899$&#123;i&#125;.sra</span><br><span class="line">done</span><br></pre></td></tr></table></figure>
</li>
<li><p>循环fastqc语句测试测序文件的质量；(<a href="http://fbb84b26.wiz03.com/share/s/3XK4IC0cm4CL22pU-r1HPcQQ1iRTvV2GwkwL2AaxYi2fXHP7" target="_blank" rel="noopener">MultiQC可以批量显示质控结果</a>）<br>（<strong>4线程，用时约25分钟</strong>）</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">for i in &#123;56..62&#125;</span><br><span class="line">do</span><br><span class="line">  fastqc -t 4 -O /Users/xiapengfei/ SRR35899$i.sra_1.fastq.gz SRR35899$i.sra_2.fastq.gz</span><br><span class="line">done  # fastqc *.fastq在当前目录中无其他同类文件时等价，其他循环或可同理</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>_<a href="https://github.com/XIAPengfei1996/Shia/tree/master/bioinfo/fastqc_html" target="_blank" rel="noopener">理解测序reads，GC含量，质量值，接头，index，fastqc的全部报告</a>_</p>
<p><a href="http://www.bio-info-trainee.com/2275.html" target="_blank" rel="noopener"><strong>经验教训</strong></a></p>
<h3 id="了解参考基因组及基因注释"><a href="#了解参考基因组及基因注释" class="headerlink" title="了解参考基因组及基因注释"></a>了解参考基因组及基因注释</h3><ul>
<li>在<a href="http://genome.ucsc.edu/index.html" target="_blank" rel="noopener">UCSC</a>中打开Downloads中Genome Data页面，点击Human选择Feb. 2009 (GRCh37/hg19)栏下Full data set，下拉找到chromFa.tar.gz文件；</li>
</ul>
<blockquote>
<p>chromFa.tar.gz - The assembly sequence in one file per chromosome.<br>    Repeats from RepeatMasker and Tandem Repeats Finder (with period<br>    of 12 or less) are shown in lower case; non-repeating sequence is<br>    shown in upper case.</p>
</blockquote>
<ul>
<li><p>axel命令下载hg19参考基因组数据；<br>（<strong>400+KB/s，用时约35分钟</strong>）</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">axel http://hgdownload.soe.ucsc.edu/goldenPath/hg19/bigZips/chromFa.tar.gz</span><br><span class="line">tar zxvf chromFa.tar.gz  # 解压该文件</span><br><span class="line">cat *.fa &gt; hg19.fa  # 将解压文件合并为一个文件</span><br><span class="line">rm chr*.fa  # 删除无关数据</span><br></pre></td></tr></table></figure>
</li>
<li><p>从<a href="http://www.gencodegenes.org" target="_blank" rel="noopener">gencode数据库</a>中打开Data中Human栏内<a href="https://www.gencodegenes.org/releases/grch37_mapped_releases.html" target="_blank" rel="noopener">GRCh37-mapped Releases</a>，点击GENCODE release栏下最新版的数据，下载基因注释文件；<br>（<strong>用时5分钟</strong>)</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">axel ftp://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_28/GRCh37_mapping/gencode.v28lift37.annotation.gtf.gz  # GTF格式主要是用来描述基因的注释</span><br><span class="line">axel ftp://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_28/GRCh37_mapping/gencode.v28lift37.annotation.gff3.gz  # GFF文件是一种用来描述基因组特征的文件，现在我们所使用的大部分都是第三版（GFF3）</span><br><span class="line"><span class="meta">#</span> gzip -d解压并删除压缩包</span><br><span class="line">gzip -d gencode.v28lift37.annotation.gtf.gz</span><br><span class="line">gzip -d gencode.v28lift37.annotation.gff3.gz</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><em>- 用IGV去查看感兴趣的基因的结构；</em></p>
<ul>
<li>下载安装<a href="https://java.com/en/download/mac_download.jsp" target="_blank" rel="noopener">JAVA 8</a>；</li>
<li>下载<a href="http://software.broadinstitute.org/software/igv/download" target="_blank" rel="noopener">igv</a>直接打开；</li>
<li>在菜单栏Genomes中选择Load Genome from File…导入hg19.fa文件；</li>
<li>在菜单栏Tools中打开Run igvtools…界面，在Command栏中选择Sort，在Input File栏中导入gtf文件后运行；</li>
<li>在菜单栏File中选择Load from File…导入sorted.gtf文件并index；</li>
<li>在工具栏输入查找的基因名词（如：TP53）或染色体定位（如chr17:7,569,720-7,592,868)查看<a href="https://github.com/XIAPengfei1996/Shia/tree/master/bioinfo/igv" target="_blank" rel="noopener">可视化结构</a>；</li>
</ul>
<h3 id="序列比对"><a href="#序列比对" class="headerlink" title="序列比对"></a>序列比对</h3><ul>
<li>从<a href="http://ccb.jhu.edu/software/hisat2/index.shtml" target="_blank" rel="noopener">HISAT2</a>的主页下载index文件；<br>（<strong>400+KB/s，用时约两个半+小时</strong>）<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">axel ftp://ftp.ccb.jhu.edu/pub/infphilo/hisat2/data/hg19.tar.gz  # 下载人类的索引</span><br><span class="line">axel ftp://ftp.ccb.jhu.edu/pub/infphilo/hisat2/data/mm10.tar.gz  # 下载小鼠的索引</span><br><span class="line">tar -zxvf *.tar.gz  # 解压压缩包</span><br><span class="line">rm -rf *.tar.gz  # 删除压缩包</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>这次分析是人类mRNA-Seq测序的结果，但是这里其实只下载了3个人类的sra文件。一般而言RNA-Seq数据分析都至少要有2个重复，所以必须要有4个sra文件才行。实际上前面原文Bioinformatic analyses部分有说该研究control组中的一组数据用的是其他课题组的：</p>
<blockquote>
<p><em><strong>For 293 cells, the mRNA-seq results of the control samples include (1) those from the doxycycline-treated parental Flp-In T-REx 293 cells by us and (2) those from the doxycycline-treated control Flp-In T-REx 293 cells performed by another group unrelated to us (sample GSM1095127 in GSE44976)31, and the two AKAP95 KD samples were from the two different clones (miR#8 and miR#12) of Flp-In T-REx 293 cells stably expressing AKAP95 microRNAs after doxycycline treatment.</strong></em></p>
</blockquote>
<p>不同来源的RNA-Seq数据的构建文库不一样,结果之间比较需要考虑<strong>批次效应（batch effect）</strong> 的影响<br>IVT-seq reveals extreme bias in RNA-sequencing 证明了不同文库的RNA-Seq结果会存在很大差异</p>
<ul>
<li><p>把fastq格式的reads比对上去得到sam文件(仅小鼠，下同)；<br>注意这一步也不显示百分数进度条！</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 比对人类的索引 9:55</span><br><span class="line"><span class="meta">#</span> for i in &#123;56..58&#125;</span><br><span class="line"><span class="meta">#</span> do</span><br><span class="line"><span class="meta">#</span>   hisat2 -t -x /Users/xiapengfei/hg19/genome -1 SRR35899$&#123;i&#125;.sra_1.fastq.gz -2 SRR35899$&#123;i&#125;.sra_2.fastq.gz -S SRR35899$&#123;i&#125;.sam</span><br><span class="line"><span class="meta">#</span> done</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 比对小鼠的索引</span><br><span class="line">for i in &#123;59..62&#125;</span><br><span class="line">do</span><br><span class="line">  hisat2 -t -x /Users/xiapengfei/hg19/genome -1 SRR35899$&#123;i&#125;.sra_1.fastq.gz -2 SRR35899$&#123;i&#125;.sra_2.fastq.gz -S SRR35899$&#123;i&#125;.sam</span><br><span class="line">done</span><br></pre></td></tr></table></figure>
</li>
<li><p>用samtools把sam文件转为bam文件，并且排序(注意N和P两种排序区别)索引好；</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">for i in &#123;59..62&#125;</span><br><span class="line">do </span><br><span class="line">  samtools view -S SRR35899$&#123;i&#125;.sam -b &gt; SRR35899$&#123;i&#125;.bam  # 将比对后的sam格式文件转换成bam文件</span><br><span class="line">  samtools sort SRR35899$&#123;i&#125;.bam -o SRR35899$&#123;i&#125;.sorted.bam  # 将所有的bam文件进行排序</span><br><span class="line">  samtools index SRR35899$&#123;i&#125;_sorted.bam # 将所有的排序文件建立索引</span><br><span class="line">done</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><em>samtools sort默认按照染色体位置进行排序，-n参数根据read名进行排序。-t参数根据TAG进行排序</em></p>
<ul>
<li>对bam文件进行质控；<br>可以使用<a href="http://rseqc.sourceforge.net/" target="_blank" rel="noopener">RSeQC</a><br><em>RSeQC的安装，需要预先安装R，Python2.7，gcc，<a href="http://www.jianshu.com/p/14fd4de54402" target="_blank" rel="noopener">numpy</a></em><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pip install RSeQC</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &#123;<span class="number">56.</span><span class="number">.62</span>&#125;</span><br><span class="line">do</span><br><span class="line">  bam_stat.py -i SRR35899$&#123;i&#125;_sorted.bam</span><br><span class="line">done</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><em>另有<a href="http://broadinstitute.github.io/picard/" target="_blank" rel="noopener">Picard</a></em><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">conda install ucsc-gtftogenepred</span><br><span class="line">gtfToGenePred -genePredExt -ignoreGroupsWithoutExons -geneNameAsName2 gencode.v28lift37.annotation.gtf gencode.v28lift37.annotation.gpd</span><br><span class="line">axel http:<span class="comment">//hgdownload.soe.ucsc.edu/goldenPath/hg19/database/refFlat.txt.gz</span></span><br><span class="line">gzip -d refFlat.txt.gz</span><br><span class="line">java -jar ~/biosoft/picard_2.8.0/picard.jar CollectRnaSeqMetrics I= Homo_sapiens_Control_293_cell_sorted.bam O=Homo_sapiens_Control_293_cell_RNA_Metrics REF_FLAT= ~/rna_seq/data/reference/genome/hg19/refFlat.txt STRAND_SPECIFICITY=NONE</span><br></pre></td></tr></table></figure></p>
<p><em>或<a href="http://qualimap.bioinfo.cipf.es/" target="_blank" rel="noopener">Qualimap</a>等工具</em></p>
<ul>
<li>IGV载入参考序列，注释和BAM文件查看略；</li>
</ul>
<h3 id="reads计数"><a href="#reads计数" class="headerlink" title="reads计数"></a>reads计数</h3><p>用htseq对比得到的bam文件进行count计数；<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">for i in $(seq 56 58)</span><br><span class="line">do </span><br><span class="line">  htseq-count -f bam -r pos -s no SRR35899$&#123;i&#125;.bam gencode.vM10.annotation.gtf SRR35899$&#123;i&#125;.count</span><br><span class="line">done</span><br></pre></td></tr></table></figure></p>
<ul>
<li>将count文件合并为表达矩阵；（59和61是control， 60和62是repeat）<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">options(stringsAsFactors = <span class="literal">FALSE</span>)</span><br><span class="line"><span class="comment"># 导入表格数据</span></span><br><span class="line">control1 &lt;- read.table(<span class="string">"SRR3589959.count"</span>, sep=<span class="string">"\t"</span>, col.names = c(<span class="string">"gene_id"</span>,<span class="string">"control"</span>))</span><br><span class="line">repeat1 &lt;- read.table(<span class="string">"SRR3589960.count"</span>, sep=<span class="string">"\t"</span>, col.names = c(<span class="string">"gene_id"</span>,<span class="string">"akap951"</span>))</span><br><span class="line">control1 &lt;- read.table(<span class="string">"SRR3589961.count"</span>, sep=<span class="string">"\t"</span>, col.names = c(<span class="string">"gene_id"</span>,<span class="string">"control"</span>))</span><br><span class="line">repeat2 &lt;- read.table(<span class="string">"SRR3589962.count"</span>, sep=<span class="string">"\t"</span>, col.names = c(<span class="string">"gene_id"</span>,<span class="string">"akap952"</span>))</span><br><span class="line"><span class="comment"># 按照gene_id合并</span></span><br><span class="line">raw_count &lt;- merge(merge(control1, control2, by=<span class="string">"gene_id"</span>), merge(repeat1, repeat2, by=<span class="string">"gene_id"</span>))</span><br><span class="line"><span class="comment"># 过滤删去5行</span></span><br><span class="line">raw_count_filt &lt;- raw_count[-<span class="number">48823</span>:-<span class="number">48825</span>, ]</span><br><span class="line">raw_count_filter &lt;- raw_count_filt[-<span class="number">1</span>:-<span class="number">2</span>, ]</span><br><span class="line"><span class="comment"># 因为EBI数据库无法直接搜索小数位，因此需要替换为整数形式</span></span><br><span class="line">ENSEMBL &lt;- gsub(<span class="string">"\\.\\d*"</span>, <span class="string">""</span>, raw_count_filter$gene_id)</span><br><span class="line"><span class="comment"># 将ENSEMBL重新添加到矩阵中</span></span><br><span class="line">row.names(raw_count_filter) &lt;- ENSEMBL</span><br><span class="line"><span class="comment"># 在EBI或UniProt数据库找到AKAP95的id，并从矩阵中找到访问，并赋值给AKAP95变量</span></span><br><span class="line">&gt; AKAP95 &lt;- raw_count_filt[rownames(raw_count_filt)==<span class="string">"ENSG00000105127"</span>,]</span><br><span class="line"><span class="comment"># 查看AKAP95基因表达情况，结果明显比对照组高</span></span><br><span class="line">&gt; AKAP95</span><br><span class="line"><span class="comment"># 查看总体情况</span></span><br><span class="line">summary(raw_count_filter)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><em>另可使用perl</em><br><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">perl -lne <span class="string">'if($ARGV=~/Homo_sapiens_(.*)_sorted.count/)&#123;print "$1\t$_"&#125;'</span> *|<span class="keyword">grep</span> -v  Homo_sapiens&gt;hg.count</span><br><span class="line"><span class="comment"># 先把所有文件进行合并</span></span><br><span class="line">setwd(<span class="string">"~/rna_seq/work/matrix"</span>)</span><br><span class="line">hg &lt;- read.csv(file = <span class="string">"hg.count"</span>,header = F,sep = <span class="string">"\t"</span>)</span><br><span class="line">colnames(hg) &lt;- c(<span class="string">'sample'</span>,<span class="string">'gene'</span>,<span class="string">'count'</span>)</span><br><span class="line">library(reshape2)</span><br><span class="line">reads &lt;- dcast(hg,formula = gene ~ sample)</span><br><span class="line">write.table(reads,file = <span class="string">"hg_join.count"</span>,sep = <span class="string">"\t"</span>,quote = FALSE,row.names = FALSE)</span><br><span class="line">summary(reads)</span><br><span class="line">sample_mean &lt;- group_by(hg,sample)%&gt;% summarize(mean=mean(count))</span><br><span class="line">gene_mean &lt;- group_by(hg,gene)%&gt;% summarize(mean=mean(count)) </span><br><span class="line">tmp &lt;- full_join(hg,gene_mean,by=<span class="string">'gene'</span>)</span><br></pre></td></tr></table></figure></p>
<h3 id="差异基因分析"><a href="#差异基因分析" class="headerlink" title="差异基因分析"></a>差异基因分析</h3><p>参考：<br><a href="https://zhuanlan.zhihu.com/p/30350531" target="_blank" rel="noopener">青山屋主</a>  <a href="https://mp.weixin.qq.com/s/1mda7NpOxShbOxZKSJar7Q" target="_blank" rel="noopener">徐洲更</a>  <a href="https://mp.weixin.qq.com/s?__biz=MzIwNTEwMTUyOQ==&amp;mid=2649694709&amp;idx=1&amp;sn=40b354fef74d3adf5aac7b8745303af2&amp;chksm=8f2d8143b85a0855404621656c5946acc4919cc61a65719c450a461ecbdeb1ff56c72fe798bb&amp;scene=21#wechat_redirect" target="_blank" rel="noopener">PANDA姐</a>/<a href="https://mp.weixin.qq.com/s?__biz=MzIwNTEwMTUyOQ==&amp;mid=2649694735&amp;idx=1&amp;sn=5ad87d24643c08ab945288e086da4359&amp;chksm=8f2d82b9b85a0baf92cc6af6f647c7e89710138a3f95e5e0a939894f21034edc57d5f7a30f52&amp;scene=21#wechat_redirect" target="_blank" rel="noopener">沈梦圆</a></p>
<ul>
<li><p>在R中安装DESeq2；（也可使用edgeR，limma等）</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">rm(list=ls())</span><br><span class="line"><span class="keyword">source</span>(<span class="string">"https://bioconductor.org/biocLite.R"</span>) <span class="comment"># 载入安装工具</span></span><br><span class="line">biocLite(<span class="string">"DESeq2"</span>)  <span class="comment"># 安装包</span></span><br><span class="line"><span class="keyword">library</span>(<span class="string">"DESeq2"</span>) <span class="comment"># 加载包，测试是否安装成功</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>正式构建dds矩阵；</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">countData &lt;- raw_count_filter</span><br><span class="line">condition &lt;- factor(c(<span class="string">"control"</span>,<span class="string">"control"</span>,<span class="string">"KD"</span>,<span class="string">"KD"</span>))</span><br><span class="line">colData &lt;- data.frame(row.names=colnames(countData), condition)</span><br><span class="line">dds &lt;- DESeqDataSetFromMatrix(countData, DataFrame(condition), design= ~ condition )</span><br><span class="line">head(dds)  <span class="comment">#查看一下构建好的矩阵</span></span><br><span class="line">dds &lt;- DESeq(dds)   <span class="comment">#对原始dds进行normalize</span></span><br><span class="line"><span class="comment"># 查看结果的名称，本次实验中是 "Intercept"，"condition_akap95_vs_control"</span></span><br><span class="line">resultsNames(dds2)</span><br><span class="line"><span class="comment"># 将结果用results()函数来获取，赋值给res变量</span></span><br><span class="line">res &lt;- results(dds2)</span><br><span class="line"><span class="comment"># summary一下，看一下结果的概要信息</span></span><br><span class="line">summary(res)</span><br></pre></td></tr></table></figure>
</li>
<li><p>提取差异分析结果；</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取padj（p值经过多重校验校正后的值）小于0.05，表达倍数取以2为对数后大于1或者小于-1的差异表达基因。</span></span><br><span class="line">&gt; table(res$padj&lt;<span class="number">0.05</span>) <span class="comment">#取P值小于0.05的结果</span></span><br><span class="line">&gt; res &lt;- res[order(res$padj),]</span><br><span class="line">&gt; diff_gene_deseq2 &lt;-subset(res,padj &lt; <span class="number">0.05</span> &amp; (log2FoldChange &gt; <span class="number">1</span> | log2FoldChange &lt; -<span class="number">1</span>))</span><br><span class="line">&gt; diff_gene_deseq2 &lt;- row.names(diff_gene_deseq2)</span><br><span class="line">&gt; resdata &lt;-  merge(as.data.frame(res),as.data.frame(counts(dds2,normalize=<span class="literal">TRUE</span>)),by=<span class="string">"row.names"</span>,sort=<span class="literal">FALSE</span>)</span><br><span class="line"><span class="comment"># 得到csv格式的差异表达分析结果</span></span><br><span class="line">&gt; write.csv(resdata,file= <span class="string">"control_vs_akap95.cvs"</span>,row.names = <span class="literal">F</span>)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="差异基因结果注释-富集分析"><a href="#差异基因结果注释-富集分析" class="headerlink" title="差异基因结果注释/富集分析"></a>差异基因结果注释/富集分析</h3><p>参考：<br><a href="https://mp.weixin.qq.com/s/p-n5jq5Rx2TqDBStS2nzoQ" target="_blank" rel="noopener">徐洲更</a>  <a href="https://www.jianshu.com/p/95c0472f5a8e" target="_blank" rel="noopener">宇天</a>  <a href="https://mp.weixin.qq.com/s?__biz=MzIwNTEwMTUyOQ==&amp;mid=2649694917&amp;idx=1&amp;sn=a318f8cf98f306d46963986011c73600&amp;chksm=8f2d8273b85a0b65270a986f7bb28e8efa7fd15309505a5a026bbedaafaff7e30e4d4f13dd02&amp;scene=21#wechat_redirect" target="_blank" rel="noopener">沈梦圆</a></p>
<ul>
<li><p>根据padj &lt; 0.05 且Log2FoldChange的绝对值大于1的标准筛选显著差异表达基因集；</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">deseq2.sig &lt;- subset(res, padj &lt; <span class="number">0.05</span> &amp; abs(log2FoldChange) &gt; <span class="number">1</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>安装下载注释数据包；（rog.HS.eg.db)</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">source</span>(<span class="string">"https://bioconductor.org/biocLite.R"</span>)</span><br><span class="line">biocLite(<span class="string">"clusterProfiler"</span>)</span><br><span class="line">biocLite（<span class="string">"AnnotationHub"</span>)</span><br><span class="line"><span class="keyword">library</span>(AnnotationHub)</span><br><span class="line">ah &lt;- AnnotationHub()</span><br><span class="line">org.hs &lt;- ah[[<span class="string">'AH53766'</span>]]</span><br></pre></td></tr></table></figure>
</li>
<li><p>GO富集和GESA；<br><em>Y叔的clusterProfiler简单好用，结果正确，没有必要专门导出数据用GSEA软件做超几何分布检验分析了</em></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ego &lt;- enrichGO(</span><br><span class="line">  gene = row.names(deseq2.sig),</span><br><span class="line">  OrgDb = org.hs,</span><br><span class="line">  keytype = <span class="string">"ENSEMBL"</span>,</span><br><span class="line">  ont = <span class="string">"MF"</span></span><br><span class="line">)</span><br><span class="line">dotplot(ego,font.size=<span class="number">5</span>)  <span class="comment"># 气泡图</span></span><br><span class="line">enrichMap(ego, vertex.label.cex=<span class="number">1.2</span>, layout=igraph::layout.kamada.kawai)</span><br><span class="line">plotGOgraph(ego)  <span class="comment"># 网络图</span></span><br><span class="line">gseaplot(gsemf, geneSetID=<span class="string">"GO:0004871"</span>)  <span class="comment"># 画GSEA标志性图</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>KEGG富集分析；</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(clusterProfiler)</span><br><span class="line">gene_list &lt;- mapIds(org.hs, keys = row.names(deseq2.sig),</span><br><span class="line">  column = <span class="string">"ENTREZID"</span>, keytype = <span class="string">"ENSEMBL"</span> )</span><br><span class="line">kk &lt;- enrichKEGG(gene_list, organism=<span class="string">"hsa"</span>,</span><br><span class="line">  keyType = <span class="string">"ncbi-geneid"</span>,</span><br><span class="line">  pvalueCutoff=<span class="number">0.05</span>, pAdjustMethod=<span class="string">"BH"</span>,</span><br><span class="line">  qvalueCutoff=<span class="number">0.1</span>)</span><br><span class="line">head(summary(kk))</span><br><span class="line">dotplot(kk)  <span class="comment"># 气泡图</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="致谢"><a href="#致谢" class="headerlink" title="致谢"></a>致谢</h3><p>感谢曾健明在其建立的生信技能树平台发起转录组入门实战项目；<br>感谢徐洲更、沈梦圆、青山屋主等在各平台上热心分享经验以资参考；<br>感谢所有论文作者和数据共享平台开放数据获取途径；<br>获益良多，相见恨晚！</p>
<h3 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h3><p>《RNA-seq数据分析实用方法》<br>（《RNA-seq Data Analysis A Practical Approach》）</p>
<h2 id="ChIP-seq基础入门"><a href="#ChIP-seq基础入门" class="headerlink" title="ChIP-seq基础入门"></a><a href="https://xiapengfei1996.github.io/bioinfo/ChIP-seq" target="_blank" rel="noopener">ChIP-seq基础入门</a></h2><h2 id="450K甲基化芯片数据处理"><a href="#450K甲基化芯片数据处理" class="headerlink" title="450K甲基化芯片数据处理"></a><a href="https://xiapengfei1996.github.io/bioinfo/Methylation450K_BeadChip" target="_blank" rel="noopener">450K甲基化芯片数据处理</a></h2><h2 id="lncRNA数据分析"><a href="#lncRNA数据分析" class="headerlink" title="lncRNA数据分析"></a><a href="https://xiapengfei1996.github.io/bioinfo/lncRNA" target="_blank" rel="noopener">lncRNA数据分析</a></h2>
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/04/03/lncRNA/" rel="prev" title="">
                 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">John Doe</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#生物信息学实战"><span class="nav-number">1.</span> <span class="nav-text">生物信息学实战</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#转录组入门"><span class="nav-number">1.1.</span> <span class="nav-text">转录组入门</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#计算机资源的准备"><span class="nav-number">1.1.1.</span> <span class="nav-text">计算机资源的准备</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#读文章拿到测序数据"><span class="nav-number">1.1.2.</span> <span class="nav-text">读文章拿到测序数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#了解fastq测序数据"><span class="nav-number">1.1.3.</span> <span class="nav-text">了解fastq测序数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#了解参考基因组及基因注释"><span class="nav-number">1.1.4.</span> <span class="nav-text">了解参考基因组及基因注释</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#序列比对"><span class="nav-number">1.1.5.</span> <span class="nav-text">序列比对</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#reads计数"><span class="nav-number">1.1.6.</span> <span class="nav-text">reads计数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#差异基因分析"><span class="nav-number">1.1.7.</span> <span class="nav-text">差异基因分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#差异基因结果注释-富集分析"><span class="nav-number">1.1.8.</span> <span class="nav-text">差异基因结果注释/富集分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#致谢"><span class="nav-number">1.1.9.</span> <span class="nav-text">致谢</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#参考文献"><span class="nav-number">1.1.10.</span> <span class="nav-text">参考文献</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ChIP-seq基础入门"><span class="nav-number">1.2.</span> <span class="nav-text">ChIP-seq基础入门</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#450K甲基化芯片数据处理"><span class="nav-number">1.3.</span> <span class="nav-text">450K甲基化芯片数据处理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#lncRNA数据分析"><span class="nav-number">1.4.</span> <span class="nav-text">lncRNA数据分析</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
